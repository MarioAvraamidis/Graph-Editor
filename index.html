<!-- index.html -->
 <!-- https://marioavraamidis.github.io/Graph-Editor/ -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <link rel="stylesheet" href="styles.css" />
  <title>Graph Editor</title>
  <!-- <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvg@3.0.7/lib/umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>   <!-- pdf export -->
</head>

<body>
    <div class="top-bar">
      <h1>CCrossings</h1>
        <!-- <div id="mode-buttons" class="mode-container">
          <button id="mode-select" class="mode-button active">Select</button>
          <button id="mode-add-bend" class="mode-button">Add Bend</button>
          <!-- <button id="mode-create-edge" class="mode-button">Create Edge</button>
        </div> -->
      
    </div>
    <!-- The canvas for drawing -->
    <!-- <canvas id="graphCanvas" width="1000" height="500" style="border:1px solid #000;"></canvas> -->

    <div class="main-container">

      <div id="left-column" >

        <div class="overlay-wrapper">
          <button id="overlayUpdateBtn" class="overlay-btn">Update</button>
          <button id="overlaySwitchBtn" class="overlay-btn">Switch Graphs</button>
          <div class="overlay-canvas-container">
            <canvas id="overlayCanvas"></canvas>
          </div>
        </div>


        <div id="controls">
          <button id="settingsBtn">Settings</button>
          <button id='newGraphBtn'>AddGraph</button>

          <button id="undo-button">Undo</button>
          <button id="redo-button">Redo</button>

          <button id="circle-placement">Circle</button>
          <button id="make-clique">Clique</button>

          <button id="resetViewButton">ResetView</button>
          <button id="fix-view">FixView</button>
          
          <div class="file-upload">
            <input type="file" id="import-input" hidden>
            <label for="import-input" class="upload-btn">Import</label>
          </div>

          <!-- <input type="file" id="import-input" accept=".json"> -->

          <div class="export-dropdown">
            <button id="export-btn">Export â–¼</button>
            <div class="export-menu">
              <a href="#" id="export-json-btn">Export as JSON</a>
              <a href="#" id="export-pdf">Export as PDF</a>
              <a href="#" id="export-image">Export as PNG</a>
            </div>
          </div>

          <button id="layout-btn">Layout</button>

          <div class="info">
            Zoom: <span id="currentZoomSpan">100%</span>
          </div>
        </div>


        <div id="output">
          <h3>Report</h3>
          <div class="label-value-pair">
              <input type="checkbox" id="show-self" data-crossing-type="self" checked style="margin-right: 5px; vertical-align: middle;">
              <label class="ticked-label-part" for="show-self" data-color-key="self" style="vertical-align: middle;">Self X-ings :</label>
              <span class="value-part" id="self-crossings"></span>
          </div>
          <div class="label-value-pair">
              <input type="checkbox" id="show-neighbor" data-crossing-type="neighbor" checked style="margin-right: 5px; vertical-align: middle;">
              <label class="ticked-label-part" for="show-neighbor" data-color-key="neighbor" style="vertical-align: middle;">Neighbor-edge X-ings :</label>
              <span class="value-part" id="neighbor-crossings"></span>
          </div>
          <div class="label-value-pair">
              <input type="checkbox" id="show-multiple" data-crossing-type="multiple" checked style="margin-right: 5px; vertical-align: middle;">
              <label class="ticked-label-part" for="show-multiple" data-color-key="multiple" style="vertical-align: middle;">Multiple X-ings :</label>
              <span class="value-part" id="multiple-crossings"></span>
          </div>
          <div class="label-value-pair">
              <input type="checkbox" id="show-legal" data-crossing-type="legal" checked style="margin-right: 5px; vertical-align: middle;">
              <label class="ticked-label-part" for="show-legal" data-color-key="legal" style="vertical-align: middle;">Legal X-ings :</label>
              <span class="value-part" id="legal-crossings"></span>
          </div>
          <div class="label-value-pair">
              <span class="label-part">Total X-ings :</span>
              <span class="value-part" id="total-crossings"></span>
          </div>
          <div class="label-value-pair">
              <span class="label-part">Thrackle :</span>
              <span class="value-part" id="thrackle-number"></span>
          </div>
          <div class="label-value-pair">
              <span class="label-part">Curve Complexity :</span>
              <span class="value-part" id="curve-complexity"></span>
          </div>
          <div class="label-value-pair">
              <input type="checkbox" id="include-report-in-export" >
              <label class="ticked-label-part" for="include-report-in-export">Include Report at exporting </label>
          </div>
        </div>
      </div>


        <div id="canvas-container">
            
            <canvas id="graphCanvas"></canvas> 
        </div>

        <div class="palette-container">
            <!--  <input type="text" id="vertexIdInput" placeholder="Vertex ID" />
                <button id="add-vertex">New Vertex</button> -->
            <!-- Vertex Palette -->
            <div id="vertex-palette" class="palette">
              <div class="palette-header">
                  <h3>Vertex</h3>
                  <span class="collapse-icon">&#9650;</span>
              </div>

              <div class="palette-content">
                <div class="palette-row">
                  <label for="vertex-color">Color:</label>
                  <input type="color" id="vertex-color" />
                </div>
              
                <div class="palette-row">
                  <label for="vertex-size">Size:</label>
                  <input type="number" id="vertex-size" min="3" max="50" />
                </div>
              
                <div class="palette-row">
                    <label>Shape:</label>
                    <div id="shape-buttons" class="shape-options"> 
                        <button class="shape-button" data-shape="circle">
                          <svg width="20" height="20"><circle cx="10" cy="12" r="7" fill="black" /></svg>
                        </button>
                        <button class="shape-button" data-shape="square">
                          <svg width="20" height="20"><rect x="4" y="6" width="12" height="12" fill="black" /></svg>
                        </button>
                        <button class="shape-button" data-shape="triangle">
                          <svg width="20" height="20">
                            <polygon points="10,2 18,18 2,18" fill="black" />
                          </svg>
                        </button>
                        <button class="shape-button" data-shape="rhombus">
                          <svg width="20" height="20">
                            <polygon points="10,2 2,10 10,18 18,10" fill="black" />
                          </svg>
                        </button>
                      </div>
                </div>

                
                <div class="palette-row" id="renameVertexElement">
                  <input type="text" id="vertexIdInput" placeholder="New ID"/>
                  <button id="rename-vertex">Rename</button>
                </div>

                <div class="show-label-checkbox">
                  <input type="checkbox" id="vertex-show-labels" checked>
                  <label for="vertex-show-labels">Show Labels</label>
                </div>

                <button id="edit-vertex-label-palette"> Edit Labels</button>
                <button id="delete-vertex-palette">Delete</button>
              </div>
            </div>
            
            <!-- Edge Palette -->
            <div id="edge-palette" class="palette">
              <div class="palette-header">
                  <h3>Edge</h3>
                  <span class="collapse-icon">&#9650;</span>
              </div>
            
              <div class="palette-content">
                <div class="palette-row">
                    <label>Color:</label>
                    <input type="color" id="edge-color" />
                </div>
            
                <div class="palette-row">
                    <label>Thickness:</label>
                    <input type="number" id="edge-thickness" min="1" max="10" step="1" />
                </div>

                <div class="palette-row">
                    <label>Type:</label>
                    <div class="edge-style-buttons"> <button id="toggle-continuous" class="edge-style-button active" title="Continuous Line">
                            <span class="line-preview line-continuous"></span>
                        </button>
                        <button id="toggle-dashed" class="edge-style-button" title="Dashed Line">
                            <span class="line-preview line-dashed"></span>
                        </button>
                    </div>
                </div>

                <div class="show-label-checkbox">
                  <input type="checkbox" id="edge-show-labels">
                  <label for="edge-show-labels">Show Label</label>
                </div>

                <div class="tickbox-label-pair">
                  <input type="checkbox" id="highlight-crossing-edges" checked >
                  <label for="highlight-crossing-edges" data-color-key="crossing">Crossing Edges</label>
                </div>

                <div class="tickbox-label-pair">
                  <input type="checkbox" id="highlight-non-crossing-edges" >
                  <label for="highlight-non-crossing-edges" data-color-key="nonCrossing">Non-Crossing Edges</label>
                </div>
                
                <button id="delete-edge-palette">Delete</button>

              </div>
            </div>

            <!-- Bend Palette -->
            <div id="bend-palette" class="palette">
              <div class="palette-header">
                  <h3>Bend</h3>
                  <span class="collapse-icon">&#9650;</span>
              </div>

              <div class="palette-content">
                  <div class="palette-row">
                      <label for="bend-color">Color:</label>
                      <input type="color" id="bend-color" />
                  </div>

                  <div class="palette-row">
                      <label for="bend-size">Size:</label>
                      <input type="number" id="bend-size" min="2" max="30" />
                  </div>

                  <div class="show-label-checkbox">
                    <input type="checkbox" id="bend-show-labels">
                    <label for="bend-show-labels">Show Label</label>
                  </div>

                  <button id="delete-bend">Delete </button>
              </div>
            </div>
        </div>
  
        </div>
    </div>
    
    <!-- Vertex information box -->
    <div id="vertex-info" style="position: absolute; display: none; background: #fff; border: 1px solid #ccc; padding: 4px; font-size: 12px; border-radius: 4px; pointer-events: none;"></div>
    <!-- Edge information box -->
    <div id="edge-info" style="position: absolute; display: none; background: #fff; border: 1px solid #ccc; padding: 4px; font-size: 12px; border-radius: 4px; pointer-events: none;"></div>
    <!-- Crossing info box -->
    <div id="crossing-info" style="position: absolute; display: none; background: #fff; border: 1px solid #ccc; padding: 4px; font-size: 12px; border-radius: 4px; pointer-events: none;"></div>

    <!-- <pre id="output"> </pre> 
    <!-- <pre id="output" style="border: 1px solid black; padding: 10px;"></pre> -->

    <!-- Context menu -->
    <div id="contextMenu" class="context-menu">
      <ul>
        <li data-action="clear-canvas">Clear Canvas</li>
        <li data-action="paste">Paste</li>
      </ul>
    </div>
    <!-- Edge menu -->
     <div id="edgeMenu" class="context-menu">
      <ul>
        <li data-action="addBend">Add Bend</li>
        <li data-action="deleteEdge">Delete Edge</li>
        <li data-action="showLabel"> Show Label</li>
        <li data-action="hideLabel"> Hide Label</li>
      </ul>
    </div>
    <!-- Copy menu -->
     <div id="selectedMenu" class="context-menu">
      <ul>
        <li data-action="copySelected">Copy Selected</li>
        <li data-action="deleteSelected">Delete</li>
        <li data-action="showLabels"> Show Labels</li>
        <li data-action="hideLabels"> Hide Labels</li>
      </ul>
    </div>
    <!-- Crossing menu -->
     <div id="pointMenu" class="context-menu">
      <ul>
        <li data-action="showLabel"> Show Label </li>
        <li data-action="hideLabel"> Hide Label </li>
      </ul>
     </div>
    <!-- Label menu -->
     <div id="labelMenu" class="context-menu">
      <ul>
        <li data-action="editLabel"> Edit Label </li>
        <li data-action="hideLabel"> Hide Label </li>
      </ul>
     </div>

    <!-- Settings modal -->
     <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Settings</h2>

            <!-- Crossing colors -->
            <div class="crossingColors" >
                <label for="crossings-colors-self">Self-Crossings Color:</label>
                <input type="color" id="crossings-colors-self" />
            </div>
            <div class="crossingColors" >
                <label for="crossings-colors-neighbor">Neighbor-Edge-Crossings Color:</label>
                <input type="color" id="crossings-colors-neighbor" />
            </div>
            <div class="crossingColors" >
                <label for="crossings-colors-multiple">Multiple-Crossings Color:</label>
                <input type="color" id="crossings-colors-multiple" />
            </div>
            <div class="crossingColors" >
                <label for="crossings-colors-legal">Legal-Crossings Color:</label>
                <input type="color" id="crossings-colors-legal" />
            </div>
            <!-- Crossing/Non-Crossing edges colors -->
            <div class="crossingColors" >
                <label for="crossing-edges-color">Crossing-Edges Color:</label>
                <input type="color" id="crossing-edges-color" />
            </div>
            <div class="crossingColors" >
                <label for="non-crossing-edges-color">Non-Crossing-Edges Color:</label>
                <input type="color" id="non-crossing-edges-color" />
            </div>
            <!-- Clique new edges color -->
             <div class="crossingColors" >
                <label for="clique-new-edges-color">Clique New Edges Color:</label>
                <input type="color" id="clique-new-edges-color" />
            </div>
            <!-- Label default font size -->
             <div class="crossingColors">
                <label for="labelDefaultFontSizeInput">Label Default Font Size: </label>
                <input type="number" id="labelDefaultFontSizeInput" min="4" max="30" step="2">
            </div>
            <!-- Checkbox for show info boxes on hovering-->
             <div class="crossingColors">
                 <label for="show-info-boxes" >Show info boxes on hovering </label>
                 <input type="checkbox" id="show-info-boxes" checked>
              </div>
            <!--
            <-- Allow loops in the graph
             <div class="crossingColors">
                 <label for="self-loops" >Self-loops </label>
                 <input type="checkbox" id="self-loops" >
              </div>
              <!-- Allow parallel edges in the graph
             <div class="crossingColors">
                 <label for="parallel-edges" >Parallel Edges</label>
                 <input type="checkbox" id="parallel-edges" >
              </div> -->

            <div class="modal-actions">
                <button id="settingsSaveButton">Save</button>
                <!-- <button id="cancelLabelButton">Cancel</button> </div> -->
            </div>
      </div>
    </div>
    
    <!-- Edit label modal -->
      <div id="editLabelModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Edit Label</h2>

            <div>
                <label for="labelNameInput">Point's Label:</label>
                <input type="text" id="labelContentInput" placeholder="Enter new label name">
            </div>

            <div>
                <label for="labelFontSizeInput">Font Size: </label>
                <input type="number" id="labelFontSizeInput" min="4" max="30" step="2">
            </div>

            <!-- <div>
                <label for="label-xOffset-input"> x offset</label>
                <input type="number" id="label-xOffset-input"> 
            </div> -->

            <div class="modal-actions">
                <button id="saveLabelButton">Save</button>
                <!-- <button id="cancelLabelButton">Cancel</button> </div> -->
            </div>
        </div>
      </div>

      <!-- New Graph Modal -->
      <div id="newGraphModal" class="modal">
        <div class="modal-content">
          <span class="close-button">&times;</span>
          <h2>New Graph</h2>

          <form id="newGraphForm">
            <!-- Option 1: Path -->
            <label>
              <input type="radio" name="graphType" value="path" required>
              Path
            </label>
            <div class="parameter" id="param-path" style="display: none;">
              <label for="pathLength">Length:</label>
              <input type="number" id="pathLength" name="pathLength" min="1" value="5">
            </div>

            <!-- Option 2: Cycle -->
            <label>
              <input type="radio" name="graphType" value="cycle">
              Circle
            </label>
            <div class="parameter" id="param-cycle" style="display: none;">
              <label for="cycleLength">Length:</label>
              <input type="number" id="cycleLength" name="cycleLength" min="3" value="5">
            </div>

            <!-- Option 3: Tree -->
            <label>
              <input type="radio" name="graphType" value="tree">
              Binary Tree
            </label>
            <div class="parameter" id="param-tree" style="display: none;">
              <label for="treeHeight">Height:</label>
              <input type="number" id="treeHeight" name="treeHeight" min="0" value="3">
            </div>

            <!-- Option 4: Complete Graph -->
            <!-- <label>
              <input type="radio" name="graphType" value="complete">
              Complete Graph
            </label>
            <div class="parameter" id="param-complete" style="display: none;">
              <label for="completeN">Number of vertices:</label>
              <input type="number" id="completeN" name="completeN" min="1" value="4">
            </div> -->

            <div class="modal-actions">
              <button type="submit" class="btn">Create</button>
              <!-- <button type="button" class="btn cancel" id="cancelNewGraph">Cancel</button> -->
            </div>
          </form>
        </div>
      </div>

      
      <!-- Layout Modal -->
      <div id="layoutModal" class="modal">
        <span class="close-button">&times;</span>
        <div class="modal-content">
          <h2>Layout</h2>

          <form id="layoutOptionsForm">
            <label>
              <input type="radio" name="layoutOption" value="path" required>
              Path
            </label>
            <div class="parameter" id="layout-param-path" style="display: none;">
              <label for="numOfCrossingsPath">Desired number of crossings:</label>
              <input type="number" id="numOfCrossingsPath" name="numOfCrossingsPath" min="0" value="0">
            </div>
            <br>
            <label>
              <input type="radio" name="layoutOption" value="opt2">
              Option 2
            </label>
            <div class="parameter" id="layout-param-opt2" style="display: none;">
              <label for="paramOpt2">Desired number of crossings:</label>
              <input type="number" id="paramOpt2" name="paramOpt2" min="0" value="10">
            </div>
            <!-- 
            <br>
            <label>
              <input type="radio" name="option" value="opt3">
              Option 3: <input type="number" name="param3" min="0" value="20">
            </label>
            -->
          </form>

          <div class="modal-actions">
            <button id="layoutCancelBtn">Cancel</button>
            <button id="layoutOkBtn">OK</button>
          </div>
        </div>
      </div>


      <!-- Custom Alert Message -->
      <div id="customAlert" class="custom-alert">
          <div class="custom-alert-content">
              <span id="customAlertMessage"></span>
              <button id="customAlertCloseBtn" class="custom-alert-close">&times;</button>
          </div>
      </div>

    <script type="module" src="dist/app.js"></script>
</body>
</html>